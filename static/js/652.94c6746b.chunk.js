"use strict";(self.webpackChunkportfolio=self.webpackChunkportfolio||[]).push([[652],{652:(e,s,r)=>{r.r(s),r.d(s,{default:()=>d});const o={loginPage:"login_loginPage__sAMCq",loginPageDark:"login_loginPageDark__NMaJN"};var t=r(43),a=r(216),i=r(532);const n={container:"registration_container__GLdY+",containerDark:"registration_containerDark__IVG8f",formError:"registration_formError__RYnee",buttonLogReg:"registration_buttonLogReg__xFPx9",switchText:"registration_switchText__DSSsu",switchLink:"registration_switchLink__ZkUWY"};var l=r(579);const c=()=>{const e=(0,a.Zp)(),{setFavoritesMoviesIds:s,setUser:r,setAuthorized:o,isDarkTheme:c}=(0,i.J)(),[d,g]=(0,t.useState)(!1),[u,h]=(0,t.useState)(!0),[m,p]=(0,t.useState)({login:"",password:"",confirmPassword:""}),[f,w]=(0,t.useState)("");(0,t.useEffect)((()=>{const s=JSON.parse(localStorage.getItem("current-user"));s&&s.isAuthorized&&(r(s.login),o(!0),g(!0),e("/home",{replace:!0}))}),[r,o,e]);const v=e=>{const{name:s,value:r}=e.target;p((e=>({...e,[s]:r})))},_=()=>{p({login:"",password:"",confirmPassword:""}),w("")};return(0,l.jsxs)("div",{className:c?n.containerDark:n.container,children:[(0,l.jsx)("h2",{children:u?"Login":"Register"}),(0,l.jsxs)("form",{onSubmit:t=>{t.preventDefault(),w("");const a=JSON.parse(localStorage.getItem("moviPortal"))||{users:[]},{users:i}=a;if(!u){if(m.password.length<8||m.login.length<8)return void w("Login and Password must be at least 8 characters long");if(m.password!==m.confirmPassword)return void w("Passwords do not match");const e=i.some((e=>e.login===m.login));if(e)return void w("User already exists");const s={login:m.login,password:m.password,isAuthorized:!1,favoritesMoviesIds:[]};return a.users.push(s),localStorage.setItem("moviPortal",JSON.stringify(a)),h(!0),void _()}const n=i.find((e=>e.login===m.login));if(!n)return void w("User not found");if(n.password!==m.password)return void w("Invalid password");const l=i.map((e=>e.login===n.login?{...e,isAuthorized:!0}:{...e,isAuthorized:!1}));localStorage.setItem("moviPortal",JSON.stringify({users:l}));const c={...n,isAuthorized:!0};localStorage.setItem("current-user",JSON.stringify(c)),r(n.login),s([]),o(!0),g(!0),_(),e("/home",{replace:!0})},className:n.form,children:[(0,l.jsx)("input",{disabled:d,type:"text",name:"login",placeholder:d?"The user is already authorized":"Login",value:m.login,onChange:v,className:n.input,required:!0}),(0,l.jsx)("input",{disabled:d,type:"password",name:"password",placeholder:d?"The user is already authorized":"Password",value:m.password,onChange:v,className:n.input,required:!0}),!u&&(0,l.jsx)("input",{type:"password",name:"confirmPassword",placeholder:"Confirm Password",value:m.confirmPassword,onChange:v,className:n.input,required:!0}),f&&(0,l.jsx)("p",{className:n.formError,children:f}),(0,l.jsx)("button",{type:"submit",className:n.buttonLogReg,disabled:d,children:u?"Login":"Register"})]}),(0,l.jsxs)("p",{className:n.switchText,children:[u?"Don't have an account?":"Already have an account?",(0,l.jsx)("span",{className:n.switchLink,onClick:()=>{h((e=>!e)),_()},children:u?" Register":" Login"})]})]})};function d(){const{isDarkTheme:e}=(0,i.J)();return(0,l.jsx)("div",{className:e?o.loginPageDark:o.loginPage,children:(0,l.jsx)(c,{})})}}}]);
//# sourceMappingURL=652.94c6746b.chunk.js.map